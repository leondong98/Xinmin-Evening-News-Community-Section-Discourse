<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>简单R入门 – Text Analysis Workshop</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-c1fac2584b48ed01fb6e278e36375074.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Text Analysis Workshop</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-seminars" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Seminars</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-seminars">    
        <li>
    <a class="dropdown-item" href="./Seminar/Seminar1.html">
 <span class="dropdown-text">Seminar 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./Seminar/Seminar2.html">
 <span class="dropdown-text">Seminar 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./Seminar/Seminar3.html">
 <span class="dropdown-text">Seminar 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./Seminar/Seminar4.html">
 <span class="dropdown-text">Seminar 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./Seminar/Seminar5.html">
 <span class="dropdown-text">Seminar 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./Seminar/Seminar6.html">
 <span class="dropdown-text">Seminar 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./Seminar/Seminar7.html">
 <span class="dropdown-text">Seminar 7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./简单R入门.html">
 <span class="dropdown-text">简单R入门</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./Tidyverse包介绍.html">
 <span class="dropdown-text">Tidyverse包介绍</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./代码帮助.html">
 <span class="dropdown-text">代码帮助</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#简单-r-入门" id="toc-简单-r-入门" class="nav-link active" data-scroll-target="#简单-r-入门">简单 R 入门</a>
  <ul class="collapse">
  <li><a href="#rstudio" id="toc-rstudio" class="nav-link" data-scroll-target="#rstudio">RStudio</a></li>
  <li><a href="#console-控制台" id="toc-console-控制台" class="nav-link" data-scroll-target="#console-控制台">1. Console （控制台）</a></li>
  <li><a href="#脚本scripts" id="toc-脚本scripts" class="nav-link" data-scroll-target="#脚本scripts">2. 脚本（Scripts)</a></li>
  <li><a href="#对象与赋值objects-assignment" id="toc-对象与赋值objects-assignment" class="nav-link" data-scroll-target="#对象与赋值objects-assignment">3. 对象与赋值（Objects &amp; assignment）</a></li>
  <li><a href="#向量vectors" id="toc-向量vectors" class="nav-link" data-scroll-target="#向量vectors">4. 向量（Vectors）</a></li>
  <li><a href="#函数vectors" id="toc-函数vectors" class="nav-link" data-scroll-target="#函数vectors">5. 函数（Vectors）</a></li>
  <li><a href="#帮助help" id="toc-帮助help" class="nav-link" data-scroll-target="#帮助help">6. 帮助（Help）</a></li>
  <li><a href="#data.frames-数据框" id="toc-data.frames-数据框" class="nav-link" data-scroll-target="#data.frames-数据框">7. data.frames (数据框)</a></li>
  <li><a href="#子集提取subsetting" id="toc-子集提取subsetting" class="nav-link" data-scroll-target="#子集提取subsetting">8. 子集提取（Subsetting）</a>
  <ul class="collapse">
  <li><a href="#符号" id="toc-符号" class="nav-link" data-scroll-target="#符号"><code>$</code> 符号</a></li>
  <li><a href="#符号-1" id="toc-符号-1" class="nav-link" data-scroll-target="#符号-1"><code>[,]</code> 符号</a></li>
  <li><a href="#逻辑运算符logical-operators" id="toc-逻辑运算符logical-operators" class="nav-link" data-scroll-target="#逻辑运算符logical-operators">逻辑运算符（Logical Operators）</a></li>
  <li><a href="#整合所学内容" id="toc-整合所学内容" class="nav-link" data-scroll-target="#整合所学内容">整合所学内容</a></li>
  </ul></li>
  <li><a href="#线性回归linear-regression" id="toc-线性回归linear-regression" class="nav-link" data-scroll-target="#线性回归linear-regression">9. 线性回归（Linear regression）</a></li>
  <li><a href="#t-tests" id="toc-t-tests" class="nav-link" data-scroll-target="#t-tests">10. T-tests</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">简单R入门</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="简单-r-入门" class="level1">
<h1>简单 R 入门</h1>
<p>讲座人：Hanxu hanxu.dong.21@ucl.ac.uk</p>
<p>如果你还没有接触过 R， 或者对上次使用 R 的操作已经有些生疏（这完全可以理解：编程就像外语学习，如果不用就会遗忘），你可以先完成这里提供的一些练习。这些练习旨在帮助你初识/回顾 R 编程的基本概念，以及如何高效使用 RStudio。</p>
<p><strong>首先，请下载 <a href="https://cran.r-project.org/mirrors.html">R</a> 和 <a href="https://posit.co/download/rstudio-desktop/">RStudio</a></strong></p>
<p><strong>这个介绍将涵盖以下主题：</strong> - 在控制台中使用 R - 在脚本文件中使用 R - 对象与赋值 - 向量（vectors） - 函数的使用 - 帮助文档的查询 - 数据框（data frames） - 子集提取（subsetting） - 线性回归（linear regression） - t 检验（t-test）</p>
<section id="rstudio" class="level2">
<h2 class="anchored" data-anchor-id="rstudio">RStudio</h2>
<p>让我们来熟悉一下 R 和 Rstudio。第一次启动 RStudio 时，你会看到三个面板：</p>
<p><img src="https://raw.githubusercontent.com/leondong98/Text-Analysis-Workshop/main/images/r_1.png" width="800"></p>
<p>接下来让我们来一个个熟悉这些面板</p>
</section>
<section id="console-控制台" class="level2">
<h2 class="anchored" data-anchor-id="console-控制台">1. Console （控制台）</h2>
<p>左侧是控制台（console），这是与 R 交互的最简单方式。你可以在控制台中输入代码（点击光标显示为 <code>&gt; |</code> 的位置），按下 ENTER 键后，R 就会执行该段代码。</p>
<p>根据你输入的内容，你可能会在控制台中看到相应的输出结果；如果你输入有误，也可能会收到警告信息或错误提示。</p>
<p>首先，让我们通过将 R 当作一个简单的计算器来熟悉控制台的使用：</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">+</span> <span class="dv">7</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>[1] 9</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span> <span class="sc">*</span> <span class="dv">6</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>[1] 30</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span> <span class="sc">/</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>[1] 3.5</code></pre>

<blockquote class="blockquote">
<p>你可以使用键盘上的光标键或方向键在控制台中编辑你的代码： - 使用 ↑（向上） 和 ↓（向下） 键可以重新运行之前输入的代码，而无需重新输入 - 使用 ↑（向上） 和 ↓（向下） 键可以重新运行之前输入的代码，而无需重新输入</p>
</blockquote>
</section>
<section id="脚本scripts" class="level2">
<h2 class="anchored" data-anchor-id="脚本scripts">2. 脚本（Scripts)</h2>
<p>控制台非常适合处理简单任务，但如果你正在进行一个项目，你会通常希望将工作保存在某种文档或文件中。R 中的脚本（script）就是包含 R 代码的纯文本文件。你可以像编辑任何文字处理或笔记应用中的文件一样编辑脚本。</p>
<p><strong>我们建议你在本课程中始终使用脚本文件进行操作。</strong></p>
<p>请使用菜单栏或工具栏按钮（如下图所示）来创建一个新的脚本文件:</p>
<p><img src="https://raw.githubusercontent.com/leondong98/Text-Analysis-Workshop/main/images/r_2.png" width="800"></p>
<p>创建脚本后，请立即为其赋予一个有意义的文件名并保存。</p>
<p>请注意 RStudio 中的脚本窗口，特别是其中标有 Run 和 Source 的两个按钮：</p>
<p><img src="https://raw.githubusercontent.com/leondong98/Text-Analysis-Workshop/main/images/r_3.png" width="300"></p>
<p>💡从脚本中运行代码有几种不同的方式： | 执行方式 | 操作说明 | |—————-|————————————————————————–| | 单行执行 | 将光标放在你要运行的行上，按下 <code>CTRL + ENTER</code>，或点击 <strong>Run</strong> 按钮 | | 多行执行 | 选中你要运行的多行代码，按下 <code>CTRL + ENTER</code>，或点击 <strong>Run</strong> 按钮 | | 整个脚本执行 | 点击 <strong>Source</strong> 按钮 |</p>
</section>
<section id="对象与赋值objects-assignment" class="level2">
<h2 class="anchored" data-anchor-id="对象与赋值objects-assignment">3. 对象与赋值（Objects &amp; assignment）</h2>
<p>R 语言中操作的基本结构称为“对象（objects）”。创建对象是将信息存储在 R 中的一种方式，我们可以为任何对象赋予任意名称。一旦创建了对象，我们就可以在后续的多种任务中使用它。</p>
<p>让我们从创建一个对象开始，该对象用于存储一个简单加法的结果。我们使用赋值运算符 <code>&lt;-</code> 来创建或更新对象。例如，如果我们希望保存 10 + 4 的结果，可以这样写：</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>my_result <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="sc">+</span> <span class="dv">4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>上面这一行代码创建了一个名为 <code>my_result</code> 的新对象，并将 <code>10 + 4</code> 的结果保存在其中。要查看 <code>my_result</code> 中的内容，只需在控制台中输入它的名字：</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>my_result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>[1] 14</code></pre>
<p>请注意，所有对象名称在 R 中都是区分大小写的，因此如果你在控制台中输入 My_Result，你将会看到如下报错信息：</p>
<pre><code>Error in eval(expr, envir, enclos): object 'My_Result' not found</code></pre>
<p>对象最有用的地方在于：一旦创建，就可以在后续的计算中使用它们。例如：</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>my_result<span class="sc">*</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>[1] 28</code></pre>
<p>你甚至可以对一个对象进行计算，并将结果赋值给一个新的对象：</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>my_new_result <span class="ot">&lt;-</span> my_result<span class="sc">*</span><span class="dv">2</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>my_new_result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>[1] 28</code></pre>
<p>现在，我们已经创建了两个对象，查看 RStudio 中的 <strong>Environment</strong> 面板，你会看到其中列出了 <code>my_result</code> 和 <code>my_new_result</code> 两个对象。</p>
<p><img src="https://raw.githubusercontent.com/leondong98/Text-Analysis-Workshop/main/images/r_4.png" width="500"></p>
<p>要从环境中删除所有对象，可以使用如上图所示的扫帚按钮（broom button）。</p>
<p>我们将对象命名为 my_result，但其实你可以使用任何名称，只要遵守以下几个简单的规则即可： - 对象名称可以包含大小写字母（A–Z，a–z）、数字（0–9）、下划线（_）或句点（.） - 但对象名称必须以字母开头 - 建议选择具有描述性且易于输入的名称，以便提高代码可读性与可维护性</p>
<table class="caption-top table">
<colgroup>
<col style="width: 17%">
<col style="width: 82%">
</colgroup>
<thead>
<tr class="header">
<th>推荐的对象名</th>
<th>不推荐的对象名</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>result</td>
<td>a</td>
</tr>
<tr class="even">
<td>my_result</td>
<td>x1</td>
</tr>
<tr class="odd">
<td>my.result</td>
<td>this.name.is.just.too.long</td>
</tr>
<tr class="even">
<td>my_new_result</td>
<td>sing,dance,rap,basketball</td>
</tr>
</tbody>
</table>
</section>
<section id="向量vectors" class="level2">
<h2 class="anchored" data-anchor-id="向量vectors">4. 向量（Vectors）</h2>
<p><code>my_result</code> 和 <code>my_new_result</code> 都是只包含单个数字的对象。但在实际操作中，我们常常需要处理相互关联的一组数字。为此，我们需要使用的基本构建模块就是<strong>向量（vectors）</strong>。</p>
<p>向量就是一组信息（通常是数字，但也可以是字符字符串或逻辑值），按特定顺序组合在一起。</p>
<p>在 R 中创建向量的一种方式是使用 <code>c()</code> 函数，它可以将多个数值“连接”（concatenate）在一起。例如，我们可以将以下数字连接成一个向量：</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>my_first_vector <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">13</span>, <span class="dv">21</span>, <span class="dv">34</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>my_first_vector</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code> [1]  0  1  1  2  3  5  8 13 21 34</code></pre>
<p>向量中数值的存储顺序是重要的，我们可以使用方括号 <code>[ ]</code> 来访问向量中的单个元素。例如，如果我们希望访问刚刚创建的向量中的第 3 个元素，可以这样操作：</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>my_first_vector[<span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code> [1]  1</code></pre>
<p>这是一个向量子集提取（subsetting）的基本示例，它可以让我们访问向量中我们想使用的部分。我们还可以使用一个向量来提取另一个向量的子集，例如<code>my_first_vector[c(1,3,5)]</code> 将返回我们向量中的第 1、3 和 5 个元素。</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>my_first_vector[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code> [1] 0 1 3</code></pre>
</section>
<section id="函数vectors" class="level2">
<h2 class="anchored" data-anchor-id="函数vectors">5. 函数（Vectors）</h2>
<p>函数是一组用于执行特定任务的指令。函数通常需要一些输入，并生成某种输出。例如，我们可以不用加号运算符 +，而使用 sum 函数来对两个或多个数字进行求和。让我们来试试将我们上面创建的向量中的所有元素相加：</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(my_first_vector)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>[1] 88</code></pre>
<p>这里我们将向量作为 <code>sum()</code> 函数的输入，输出结果是 88。你可以手动检查这个结果是否正确，或者直接相信 R 能够正确地计算这些数字的总和。</p>
<p>函数的调用必须使用圆括号 <code>()</code>。传递给函数的输入称为参数（arguments），它们被放在括号内。函数的输出通常会显示在屏幕上，但我们也可以选择将其输出结果保存下来。例如：</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>vec_sum <span class="ot">&lt;-</span> <span class="fu">sum</span>(my_first_vector)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>vec_sum</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>[1] 88</code></pre>
<p>在这里，<code>vec_sum</code> 也是一个对象！所以我们对一些数据（<code>my_first_vector</code>）执行了一个计算（<code>sum()</code>），并将结果（<code>vec_sum</code>）存储了下来。</p>
<p>尝试对我们创建的向量应用其他函数。例如，你可以尝试使用 <code>mean()</code>、<code>median()</code>、<code>max()</code> 和 <code>min()</code>。这些结果是否与你的预期一致？</p>
<p>⚠️请注意，R 中的函数名称也是区分大小写的！ 这意味着，<code>mean(my_first_vector)</code> 可以正确计算向量的平均值，而 <code>Mean(my_first_vector)</code> 则会报错。</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(my_first_vector)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(my_first_vector)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(my_first_vector)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(my_first_vector)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>[1] 8.8
[1] 4
[1] 34
[1] 0</code></pre>
</section>
<section id="帮助help" class="level2">
<h2 class="anchored" data-anchor-id="帮助help">6. 帮助（Help）</h2>
<p>在控制台右下角，你会看到一个面板，包含名为 <code>Plots</code>、<code>Packages</code>、<code>Help</code> 和 <code>Viewer</code> 的多个标签页。现在我们暂时用不到大部分内容，但让我们先了解一下 <code>Help</code> 面板。</p>
<p>在 R 中，任何函数都有对应的帮助文件。例如，如果我们想了解如何使用 <code>sum()</code> 函数，可以输入：</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">help</span>(sum)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>问号 <code>?</code> 也可以作为快捷方式来访问在线帮助:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>?sum</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="https://raw.githubusercontent.com/leondong98/Text-Analysis-Workshop/main/images/r_5.png" width="900"></p>
<p>你可以使用上图所示的工具栏按钮，将帮助内容展开并在新窗口中显示。</p>
<p>R 中函数的帮助页面遵循一致的结构，通常包括以下几个部分：</p>
<table class="caption-top table">
<colgroup>
<col style="width: 17%">
<col style="width: 82%">
</colgroup>
<thead>
<tr class="header">
<th>项目</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Description</td>
<td>函数的简要描述</td>
</tr>
<tr class="even">
<td>Usage</td>
<td>包括所有参数（输入）的完整语法或用法</td>
</tr>
<tr class="odd">
<td>Arguments</td>
<td>每个参数的解释</td>
</tr>
<tr class="even">
<td>Details</td>
<td>关于该函数及其参数的任何相关详细信息</td>
</tr>
<tr class="odd">
<td>Value</td>
<td>函数的输出值</td>
</tr>
<tr class="even">
<td>Examples</td>
<td>使用该函数的示例</td>
</tr>
</tbody>
</table>
</section>
<section id="data.frames-数据框" class="level2">
<h2 class="anchored" data-anchor-id="data.frames-数据框">7. data.frames (数据框)</h2>
<p><code>data.frame</code> 是一种以表格形式存储数据的对象，类似于电子表格的结构，其中每一列代表一个变量，每一行代表一个观测单位。</p>
<p>虽然你可以手动创建一个 <code>data.frame</code>，但在大多数情况下，你会从文件中加载一个数据集，而在 R 中它将被表示为一个 <code>data.frame</code>。不过现在我们将使用一个 R 中预装的数据集。</p>
<p>让我们来看一个名为 <code>longley</code> 的宏观经济数据集。为此，请在你的 R 脚本中运行以下代码：</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(longley)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><code>longley</code> 数据集是一个包含 7 个变量 和 16 个观测值 的 <code>data.frame</code>。</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">help</span>(longley)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>帮助页面对这 7 个变量中的每一个都进行了描述。现在让我们来看一下 longley 数据集中的内容:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>longley</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<details>
<summary>
Click to show output
</summary>
<pre style="overflow-x: auto; max-height: 400px; white-space: pre; font-family: monospace; background-color: #f8f8f8; padding: 1em; border-radius: 6px;">
     GNP.deflator     GNP Unemployed Armed.Forces Population Year Employed
1947         83.0 234.289      235.6        159.0    107.608 1947   60.323
1948         88.5 259.426      232.5        145.6    108.632 1948   61.122
1949         88.2 258.054      368.2        161.6    109.773 1949   60.171
1950         89.5 284.599      335.1        165.0    110.929 1950   61.187
1951         96.2 328.975      209.9        309.9    112.075 1951   63.221
1952         98.1 346.999      193.2        359.4    113.270 1952   63.639
1953         99.0 365.385      187.0        354.7    115.094 1953   64.989
1954        100.0 363.112      357.8        335.0    116.219 1954   63.761
1955        101.2 397.469      290.4        304.8    117.388 1955   66.019
1956        104.6 419.180      282.2        285.7    118.734 1956   67.857
1957        108.4 442.769      293.6        279.8    120.445 1957   68.169
1958        110.8 444.546      468.1        263.7    121.950 1958   66.513
1959        112.6 482.704      381.3        255.2    123.366 1959   68.655
1960        114.2 502.601      393.1        251.4    125.368 1960   69.564
1961        115.7 518.173      480.6        257.2    127.852 1961   69.331
1962        116.9 554.894      400.7        282.7    130.081 1962   70.551

</pre>
</details>
<p>我们也可以使用 <code>View</code> 函数查看 <code>longley</code> 数据集，该函数会以类似电子表格的形式显示数据框:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(longley)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="子集提取subsetting" class="level2">
<h2 class="anchored" data-anchor-id="子集提取subsetting">8. 子集提取（Subsetting）</h2>
<p>在分析 <code>data.frame</code> 时，我们通常希望对数据进行子集提取。也就是说，我们常常只想从数据中选择某些特定的行或特定的列。</p>
<section id="符号" class="level3">
<h3 class="anchored" data-anchor-id="符号"><code>$</code> 符号</h3>
<p>访问 <code>data.frame</code> 中单个列的最简单方法是使用符号 <code>$</code>。例如，我们来看如何只访问 <code>Year</code> 这一列：</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>longley<span class="sc">$</span>Year</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code> [1] 1947 1948 1949 1950 1951 1952 1953 1954 1955 1956 1957 1958 1959 1960 1961
[16] 1962</code></pre>
<p>没错，这是一个向量（vector）！也就是说，它是一组按顺序连接在一起的信息。因此，我们可以像前面示例中那样，访问该向量中的特定元素。例如：</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>longley<span class="sc">$</span>Year[<span class="dv">7</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>[1] 1953</code></pre>
<p><code>longley$Year</code> 向量的第七个元素是 1953。</p>
<p>现在，请你试着使用 <code>$</code> 来访问 <code>GNP</code> 变量,请查看其第 1、2 和 10 个元素的值：</p>
<details>
<summary>
Reveal answer
</summary>
<div class="sourceCode" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>longley<span class="sc">$</span>Year[<span class="dv">7</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code> [1] 234.289 259.426 258.054 284.599 328.975 346.999 365.385 363.112 397.469
[10] 419.180 442.769 444.546 482.704 502.601 518.173 554.894  </code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>longley<span class="sc">$</span>GNP[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">10</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>[1] 234.289 259.426 419.180</code></pre>

</details>
</section>
<section id="符号-1" class="level3">
<h3 class="anchored" data-anchor-id="符号-1"><code>[,]</code> 符号</h3>
<p>我们之前提到，可以使用方括号 <code>[ ]</code> 对向量进行子集提取。 在处理 <code>data.frame</code> 时，我们通常希望访问某些特定的观测值（行）、变量（列），或两者的组合，而不是一次性查看整个数据集。我们也可以使用方括号 <code>[,]</code> 对数据框进行子集提取。</p>
<p>在方括号中，我们用逗号分隔行坐标和列坐标。行坐标写在前，列坐标写在后。例如： - <code>longley[10, 3]</code> 返回数据框第 10 行第 3 列 的内容。 - 如果省略列坐标，表示取该行的所有列：<code>longley[10, ]</code> 返回第 10 行 的所有数据。 - 如果省略行坐标，表示取该列的所有行：<code>longley[, 3]</code> 返回第 3 列 的全部内容。</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>longley[<span class="dv">10</span>, <span class="dv">3</span>] <span class="co"># 第 10 行第 3 列中的元素</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>[1] 282.2</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>longley[<span class="dv">10</span>, ] <span class="co"># 整个第 10 行的元素</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>     GNP.deflator    GNP Unemployed Armed.Forces Population Year Employed
1956        104.6 419.18      282.2        285.7    118.734 1956   67.857</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>longley[, <span class="dv">3</span>] <span class="co"># 整个第 3 列的元素</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code> [1] 235.6 232.5 368.2 335.1 209.9 193.2 187.0 357.8 290.4 282.2 293.6 468.1
[13] 381.3 393.1 480.6 400.7</code></pre>
<p>我们可以用方括号中的冒号来查看数据集的前五行，例如：<code>longley[1:5,]</code>。我们也可以使用方括号中的 <code>c()</code> 函数来显示数据集的第二列和第五列，例如：<code>longley[, c(2,5)]</code>。</p>
<p>💻请试试查看 <code>longley</code> 数据集的所有列并显示第 10 到 15 行。接着显示数据集的所有列但只显示第 4 和第 7 行。</p>
<details>
<summary>
Reveal answer
</summary>
<div class="sourceCode" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>longley[<span class="dv">10</span><span class="sc">:</span><span class="dv">15</span>, ] <span class="co"># 数据集的所有列并显示第 10 到 15 行</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>     GNP.deflator     GNP Unemployed Armed.Forces Population Year Employed
1956        104.6 419.180      282.2        285.7    118.734 1956   67.857
1957        108.4 442.769      293.6        279.8    120.445 1957   68.169
1958        110.8 444.546      468.1        263.7    121.950 1958   66.513
1959        112.6 482.704      381.3        255.2    123.366 1959   68.655
1960        114.2 502.601      393.1        251.4    125.368 1960   69.564
1961        115.7 518.173      480.6        257.2    127.852 1961   69.331</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>longley[<span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">7</span>), ] <span class="co"># 数据集的所有列但只显示第 4 和第 7 行</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>     GNP.deflator     GNP Unemployed Armed.Forces Population Year Employed
1950         89.5 284.599      335.1        165.0    110.929 1950   61.187
1953         99.0 365.385      187.0        354.7    115.094 1953   64.989</code></pre>

</details>
</section>
<section id="逻辑运算符logical-operators" class="level3">
<h3 class="anchored" data-anchor-id="逻辑运算符logical-operators">逻辑运算符（Logical Operators）</h3>
<p>我们也可以通过逻辑值和逻辑运算符进行子集提取。R 中有两个用于表示逻辑值的特殊表示：<code>TRUE</code> 和 <code>FALSE</code>。R 还有许多逻辑运算符，例如：大于<code>&gt;</code>、小于<code>&lt;</code> 和 等于<code>==</code>。</p>
<p>当我们将逻辑运算符应用于一个对象时，返回的值应该是一个逻辑值。例如：</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">&gt;</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>[1] TRUE</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">&lt;</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>[1] FALSE</code></pre>
<p>在这里，当我们询问 R 是否 2 &gt; 1，R 返回逻辑值 <code>TRUE</code>；当我们询问 2 &lt; 1 时，R 返回逻辑值 <code>FALSE</code>。</p>
<p>在子集提取中，逻辑操作非常有用，因为它们可以用来指定我们希望返回向量或数据框中的哪些元素。例如，假设我们只想使用 <code>longley</code> 数据集中 1955 年及以后的数据。为了将数据子集提取为这些观测值，我们可以这样做：</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>longley[longley<span class="sc">$</span>Year <span class="sc">&gt;</span> <span class="dv">1954</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>     GNP.deflator     GNP Unemployed Armed.Forces Population Year Employed
1955        101.2 397.469      290.4        304.8    117.388 1955   66.019
1956        104.6 419.180      282.2        285.7    118.734 1956   67.857
1957        108.4 442.769      293.6        279.8    120.445 1957   68.169
1958        110.8 444.546      468.1        263.7    121.950 1958   66.513
1959        112.6 482.704      381.3        255.2    123.366 1959   68.655
1960        114.2 502.601      393.1        251.4    125.368 1960   69.564
1961        115.7 518.173      480.6        257.2    127.852 1961   69.331
1962        116.9 554.894      400.7        282.7    130.081 1962   70.551</code></pre>
<p>这里发生了什么？让我们来慢慢分析一下这段代码： - 我们使用 <code>$</code> 符号从数据框 <code>longley</code> 中提取变量 <code>Year</code> - 我们要求 R 告诉我们该变量中哪些观测值大于 1954 - 我们使用 <code>[ , ]</code>对数据框 <code>longley</code> 进行子集提取，只保留满足该条件的观测值</p>
<p>如果我们只对方括号中的代码进行求值，就可以看到更详细的情况：</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>longley<span class="sc">$</span>Year <span class="sc">&gt;</span> <span class="dv">1954</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code> [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE
[13]  TRUE  TRUE  TRUE  TRUE</code></pre>
<p>你可以看到，R 对于 <code>Year</code> 大于 1954 的观测值返回 <code>TRUE</code>，否则返回 <code>FALSE</code>。正是这个逻辑向量被用在方括号中，用于对子集提取 <code>data.frame</code>。</p>
<p>💻现在轮到你来试试！请使用逻辑运算符，将 <code>longley</code> 数据集子集化，仅保留那些 <code>Population</code>小于 115 的观测值。</p>
<details>
<summary>
Reveal answer
</summary>
<div class="sourceCode" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>longley[longley<span class="sc">$</span>Population <span class="sc">&lt;</span> <span class="dv">115</span>, ] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>     GNP.deflator     GNP Unemployed Armed.Forces Population Year Employed
1947         83.0 234.289      235.6        159.0    107.608 1947   60.323
1948         88.5 259.426      232.5        145.6    108.632 1948   61.122
1949         88.2 258.054      368.2        161.6    109.773 1949   60.171
1950         89.5 284.599      335.1        165.0    110.929 1950   61.187
1951         96.2 328.975      209.9        309.9    112.075 1951   63.221
1952         98.1 346.999      193.2        359.4    113.270 1952   63.639</code></pre>

</details>
</section>
<section id="整合所学内容" class="level3">
<h3 class="anchored" data-anchor-id="整合所学内容">整合所学内容</h3>
<p>现在我们已经学习了函数、子集提取和对象赋值的相关内容，现在我们要将这三者结合起来使用。</p>
<p>🖊️让我们试着比较一下 1955 年之前和之后美国的 GNP 平均水平。在查看下方答案前，先试试使用你上面学到的工具来完成这个任务。</p>
<details>
<summary>
Reveal answer
</summary>
<div class="sourceCode" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>mean_gnp_pre_55 <span class="ot">&lt;-</span> <span class="fu">mean</span>(longley[longley<span class="sc">$</span>Year <span class="sc">&lt;</span> <span class="dv">1955</span>,]<span class="sc">$</span>GNP)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>mean_gnp_post_55 <span class="ot">&lt;-</span> <span class="fu">mean</span>(longley[longley<span class="sc">$</span>Year <span class="sc">&gt;=</span> <span class="dv">1955</span>,]<span class="sc">$</span>GNP)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>mean_gnp_pre_55</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>mean_gnp_post_55</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>[1] 305.1049
[1] 470.292</code></pre>
<p>这段代码中发生了什么？对于上面结果的第一行，我们可以按如下方式描述每个步骤： - <code>longley$Year &lt; 1955</code> 选取了 <code>longley</code> 中 <code>Year</code> 小于 1955 的那些行 - <code>$GNP</code> 选取了 <code>GNP</code> 变量 - <code>mean()</code> 计算了该变量的平均值 - <code>mean_gnp_pre_55 &lt;-</code> 将该计算结果赋值给对象 <code>mean_gnp_pre_55</code></p>
<p>我们在第二行中只是对不同的数据子集重复了相同的步骤，其中 <code>longley$Year &gt;= 1955</code> 选取了 <code>Year</code> 大于或等于 1955 的那些行。</p>

</details>
</section>
</section>
<section id="线性回归linear-regression" class="level2">
<h2 class="anchored" data-anchor-id="线性回归linear-regression">9. 线性回归（Linear regression）</h2>
<p>R 中的线性回归是通过 <code>lm()</code> 函数实现的。使用<code>lm()</code> 函数需要知道两件事：a) 我们要建模的关系；b) 包含观测数据的数据集。</p>
<p>我们需要为 <code>lm()</code> 函数提供的两个参数如下所述：</p>
<table class="caption-top table">
<colgroup>
<col style="width: 43%">
<col style="width: 56%">
</colgroup>
<thead>
<tr class="header">
<th>参数 (Argument)</th>
<th>描述 (Description)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>formula</code></td>
<td><code>formula</code> 用于描述因变量与自变量之间的关系，例如 <code>dependent.variable ~ independent.variable</code></td>
</tr>
<tr class="even">
<td><code>data</code></td>
<td>数据集中包含相关变量的名称</td>
</tr>
</tbody>
</table>
<p>要了解 <code>lm()</code> 函数的更多信息，也可以在 R 中输入 <code>help(lm)</code>。</p>
<p>💻延续上面的示例，请运行一个线性回归，其中 <code>GNP</code> 是因变量，自变量是一个二元变量：当 Year ≥ 1955 时取值为 1，否则为 0（你需要自行对该变量进行编码）。 再次提醒：在查看下面的答案前，请尽量自己尝试完成这个任务。</p>
<details>
<summary>
Reveal answer
</summary>
<div class="sourceCode" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 编码二元自变量</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>longley<span class="sc">$</span>post_1955 <span class="ot">&lt;-</span> longley<span class="sc">$</span>Year <span class="sc">&gt;=</span> <span class="dv">1955</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 运行回归</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>gnp_ols <span class="ot">&lt;-</span> <span class="fu">lm</span>(GNP <span class="sc">~</span> post_1955, longley)</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 概述回归结果</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(gnp_ols)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>Call:
lm(formula = GNP ~ post_1955, data = longley)

Residuals:
    Min      1Q  Median      3Q     Max 
-72.823 -46.022  -4.047  43.391  84.602 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     305.10      18.67  16.341 1.63e-10 ***
post_1955TRUE   165.19      26.40   6.256 2.11e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 52.81 on 14 degrees of freedom
Multiple R-squared:  0.7365,    Adjusted R-squared:  0.7177 
F-statistic: 39.14 on 1 and 14 DF,  p-value: 2.105e-05</code></pre>
<p>回归系数是 165.19 这和上面 “手动”计算的均值差相同。</p>

</details>
</section>
<section id="t-tests" class="level2">
<h2 class="anchored" data-anchor-id="t-tests">10. T-tests</h2>
<p>t 检验（t-test） 是一种常用的统计方法，用于比较两个样本或一个样本与一个已知值之间的均值差异是否显著。它主要用于样本量较小且总体标准差未知的情况下。t 检验根据样本的均值差异、样本大小和方差来计算一个 t 统计量，然后根据这个统计量与 t 分布进行比较，以判断差异是否显著（即是否可能是由于随机误差造成的）。是否显著由 p 值 决定（通常以 p &lt; 0.05 为显著性水平的标准）。</p>
<p>让我们在 R 中用 t 检验 来计算均值差异，使用 <code>t.test()</code> 函数。该函数的语法如下：</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(formula, mu, alt, conf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<table class="caption-top table">
<colgroup>
<col style="width: 47%">
<col style="width: 52%">
</colgroup>
<thead>
<tr class="header">
<th>参数 (Arguments)</th>
<th>描述 (Description)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>formula</code></td>
<td>用于描述因变量和自变量之间的关系，例如：<code>dependent.variable ~ independent.variable`。我们将在 t 检验中使用该公式以比较均值差异。 | |</code>mu<code>| 设置原假设。原假设为总体均值之间的真实差异为 0，因此我们设置</code>mu = 0<code>。 | |</code>alt<code>| 设置备择假设。假设均值差异为 0 的情况下，备择可以是差异更大或更小。若需对两者同时进行检验，设置为</code>alt = “two.sided”<code>。 | |</code>conf``</td>
</tr>
</tbody>
</table>
<p>让我们使用 <code>t.test()</code> 函数比较 1955 年之前与1955 年及之后两个时期的 <code>GNP</code> 平均水平:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(longley<span class="sc">$</span>GNP <span class="sc">~</span> longley<span class="sc">$</span>post_1955, <span class="at">mu =</span> <span class="dv">10000</span>, <span class="at">alt =</span> <span class="st">"two.sided"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>    Welch Two Sample t-test

data:  longley$GNP by longley$post_1955
t = -384.98, df = 13.992, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means between group FALSE and group TRUE is not equal to 10000
95 percent confidence interval:
 -221.8222 -108.5521
sample estimates:
mean in group FALSE  mean in group TRUE 
           305.1049            470.2920</code></pre>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>