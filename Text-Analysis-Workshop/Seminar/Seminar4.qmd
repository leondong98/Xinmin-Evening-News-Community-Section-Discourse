---
title: Seminar4

---

# 研讨会4: 语言模型B：主题模型

讲座人：Hanxu hanxu.dong.21@ucl.ac.uk

<p>
  <a href="https://pan.baidu.com/s/1BLUgiSeJDD0M9C3G4rjyKw 提取码: 7rw0" 
     style="display:inline-block; background-color:#4CAF50; color:white; padding:10px 20px; text-decoration:none; margin-right:10px; border-radius:5px;">
    Seminar data
  </a>


## 4.1 报告的主题模式

美国国务院多年来一直定期编写有关世界各地人权做法的报告。在2018年发表的一篇[论文](https://doi.org/10.1017/psrm.2016.44)中，Benjamin Baozzi 和 Daniel Berliner 对这些报告进行了分析，以确定一系列主题，并描述这些主题如何随时间和空间而变化。

在今天的研讨会上，我们将分析这个报告（1977-2012 年），通过应用结构主题模型（STMs）来确定整个语料库和每份报告中受关注和审查的基本主题。我们还将评估不同主题在语料库中的流行程度与各国与美国关系的协变量之间的关系。

> 在本次研讨中所使用的美国国务院人权报告数据集，纯粹是出于其文本结构与主题建模分析的适用性考虑。我无意讨论或评判任何国家或政府的人权状况，也不认为该数据集所反映的内容具有客观全面的代表性。此外，我不认同美国人权报告中所表达的许多观点和立场，尤其是在其可能带有政治偏见和选择性描述的内容方面。此次分析仅作为文本建模方法的教学案例。
    
## 4.2 Packages
在开始研讨会时，先下载/加载以下 R 包：

```r
library(stm)
library(tidyverse)
library(quanteda)
# 如果无法加载这些库，请先尝试安装。例如：
# install.packages("stm")  
```

## 4.3 数据集

下表介绍了该数据集中的一些变量：

| 变量名            | 描述说明                                               |
|------------------|--------------------------------------------------------|
| `cname`          | 报告所涉及国家的名称                                   |
| `year`           | 报告年份                                               |
| `report`         | 报告文本（文本已完成词干化处理，并去除停用词）       |
| `alliance`       | 该国是否与美国有正式军事同盟（1 表示是，0 表示否）    |
| `p_polity2`      | 国家对应的 polity 民主指数得分                         |
| `logus_aid_econ` | 美国对该国提供的经济援助的对数值（log 形式）          |
| `oecd`           | 是否为 OECD 成员国（哑变量）                          |
| `civil_war`      | 是否存在内战（哑变量）                                 |

一旦你下载了这个文件并将其保存在一个合适的位置，你可以使用以下命令将其加载到 R 中：

```r
human_rights <- read_csv("human_rights_reports.csv")
```

使用 ``tidyverse`` 包中的 ``glimpse()`` 函数快速查看数据中的变量：
                 
```r
glimpse(human_rights)
```
```
Rows: 4,067
Columns: 16
$ cname             <chr> "Albania", "Albania", "Albania", "Albania", "Albania…
$ year              <dbl> 1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987, 1988…
$ cowcode           <dbl> 339, 339, 339, 339, 339, 339, 339, 339, 339, 339, 33…
$ logwdi_gdpc       <dbl> 7.524573, 7.560410, 7.568337, 7.558117, 7.524482, 7.…
$ p_polity2         <dbl> -9, -9, -9, -9, -9, -9, -9, -9, -9, -9, 1, 1, 5, 5, …
$ alliance          <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…
$ logus_aid_econ    <dbl> 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000…
$ civilwar          <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…
$ oecd              <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…
$ logtrade_with_US  <dbl> 3.010621, 2.502255, 3.131137, 2.263844, 2.627563, 2.…
$ latentmean_Fariss <dbl> -0.915279270, -1.060029900, -1.053791400, -1.0242505…
$ gd_ptsa           <dbl> 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 2, 2, 3, 3, 3, 4…
$ years_to_election <dbl> 0, 3, 2, 1, 0, 3, 2, 1, 0, 3, 2, 1, 0, 3, 2, 1, 0, 3…
$ rep_pres          <dbl> 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0…
$ pres_chambers     <dbl> 2, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 2, 2, 0, 0, 0…
$ report            <chr> "albania isol balkan nation peopl govern communist r…              
```
    
## 4.4 无协变量的 STM

我们将首先实现结构主题模型的空模型。该模型等同于相关主题模型（Correlated Topic Model）--是我们在讲座中介绍过的 LDA 模型的近亲，不过在该模型中，允许语料库中的主题彼此相关（LDA 假设主题互不相关）。

你可以使用 ``stm`` 软件包中的 ``stm()`` 函数来拟合模型。你需要为该函数指定几个不同的参数：

| 参数名        | 描述说明                                                                 |
|---------------|--------------------------------------------------------------------------|
| `documents`   | 拟用于拟合 STM 模型的文档特征矩阵（DFM）                                |
| `K`           | 你希望估计的主题数量                                                     |
| `prevalence`  | 一个不包含响应变量的公式，用于指定你希望用于建模文档中主题分布的协变量 |
| `content`     | 一个不包含响应变量的公式，用于指定你希望用于建模每个主题内容的协变量   |
| `seed`        | 一个种子数，用于使结果具有可重复性                                       |

1. 从 ``human_rights`` 数据中创建一个语料库。然后创建一个 DFM，并做出一些特征选择决策（主题模型可能需要很长时间才能估算出来，因此我建议先对 DFM 进行修剪，使其暂时保持在合理的小范围内）

<details>
<summary>Reveal Code</summary>
 
```r
human_rights_corpus <- human_rights %>%
  corpus(text_field = "report")

human_rights_dfm <- human_rights_corpus %>%
                        tokens() %>%
                        dfm()

human_rights_dfm <- human_rights_dfm %>%
  dfm_trim(min_docfreq = .1,
           max_docfreq = .9,
           docfreq_type = "prop")
``` 
    
</details>  

2. 使用 ``stm`` 包中的 ``stm()`` 函数拟合一个主题模型。你需要选择一个合适的主题数量（K），并注意：此问题不应使用任何协变量；由于 STM 模型运行时间较长（通常需一两分钟），你应保存模型结果，以避免重复运行模型代码。

<details>
<summary>Reveal Code</summary>
 
```r
stm_out <- stm(documents = human_rights_dfm,
               K = 15,
               seed = 12345)
``` 

```r
save(stm_out, file = "stm_out.Rdata")
``` 
    
</details>  
    
3. 使用 ``plot()`` 函数评估每个主题在该语料库中的常见程度。最常见的主题是什么？最不常见的是什么？

<details>
<summary>Reveal Code</summary>
    
```r
plot(stm_out)
``` 

<img src="https://raw.githubusercontent.com/leondong98/Text-Analysis-Workshop/main/images/4_1.png" width="700"/>
    
</details> 

3. 使用 ``labelTopics()`` 函数提取每个主题中最具代表性的词语。对这些主题“标签”进行一些解释。（注意，``stm`` 包为加权词语在估计的主题模型中提供了各种不同的度量方法。对我们来说最相关的两个是 ``Highest Prob`` 和 ``FREX``。``Highest Prob`` 简单地报告在每个主题中具有最高概率的词（即直接从参数推断得出）。``FREX`` 是一种结合了频率和排他性的加权方法（当一个词在某一主题中常见但在其他主题中不常见时，其权重会上升））
a. 是否存在一个关于性暴力的主题？是否存在一个关于选举操控的主题？
b. 使用 cloud() 函数为两个最有趣的主题创建词云图。

<details>
<summary>Reveal Code</summary>
    
```r
labelTopics(stm_out)
``` 
```
Topic 1 Top Words:
     Highest Prob: israel, west, bank, arab, territori, militari, occupi 
     FREX: israel, west, bank, territori, arab, occupi, east 
     Lift: israel, west, strip, arab, occupi, bank, territori 
     Score: israel, arab, west, territori, jewish, bank, east 
Topic 2 Top Words:
     Highest Prob: presid, code, ministri, minimum, enforc, minist, opposit 
     FREX: code, franc, french, interior, minimum, radio, gendarmeri 
     Lift: franc, gendarmeri, french, leagu, le, apprenticeship, slaveri 
     Score: franc, gendarmeri, code, presid, french, ministri, disabl 
Topic 3 Top Words:
     Highest Prob: civilian, war, militari, regim, attack, special, execut 
     FREX: war, regim, iraq, southern, revolutionari, insurg, north 
     Lift: iraq, revolutionari, regim, war, casualti, government-control, summarili 
     Score: iraq, insurg, war, regim, revolutionari, civilian, militia 
Topic 4 Top Words:
     Highest Prob: traffick, victim, child, sexual, violenc, ministri, ngos 
     FREX: roma, sexual, traffick, societ, corrupt, exploit, victim 
     Lift: roma, bisexu, transgend, chat, lesbian, reproduct, gay 
     Score: roma, traffick, ngos, internet, sexual, child, ombudsman 
Topic 5 Top Words:
     Highest Prob: militari, indigen, judg, ministri, crime, end, presid 
     FREX: indigen, guerrilla, de, kidnap, paramilitari, congress, prosecutor 
     Lift: guerrilla, jose, carlo, inter-american, san, homicid, el 
     Score: guerrilla, indigen, jose, inter-american, carlo, ombudsman, el 
Topic 6 Top Words:
     Highest Prob: guarante, militari, amnesti, recent, rate, will, peopl 
     FREX: guarante, tion, ment, communist, now, growth, current 
     Lift: vital, ment, tion, non-government, inter, guarante, invas 
     Score: vital, tion, ment, communist, guarante, indian, now 
Topic 7 Top Words:
     Highest Prob: provinc, sentenc, chines, detain, activist, china, provinci 
     FREX: provinc, chines, china, provinci, dissid, activist, enterpris 
     Lift: china, chines, provinc, dissid, anniversari, provinci, crackdown 
     Score: china, chines, provinc, dissid, provinci, internet, communist 
Topic 8 Top Words:
     Highest Prob: see, end, soldier, child, journalist, militari, civilian 
     FREX: soldier, rebel, idp, fgm, girl, arm, unlik 
     Lift: rebel, fgm, idp, loot, soldier, unlik, rob 
     Score: rebel, idp, fgm, soldier, see, ngos, ethnic 
Topic 9 Top Words:
     Highest Prob: south, african, black, end, parliament, africa, white 
     FREX: black, african, south, white, africa, farm, magistr 
     Lift: white, black, africa, african, color, south, customari 
     Score: white, african, south, africa, black, parliament, magistr 
Topic 10 Top Words:
     Highest Prob: islam, ministri, see, muslim, sentenc, council, sharia 
     FREX: islam, sharia, non-muslim, king, muslim, bahai, christian 
     Lift: bahai, non-muslim, sunni, sharia, moham, ali, islam 
     Score: bahai, islam, sharia, sunni, non-muslim, king, arab 
Topic 11 Top Words:
     Highest Prob: opposit, presid, militari, detain, minist, leader, detaine 
     FREX: opposit, decre, coup, martial, ralli, ban, emerg 
     Lift: martial, coup, campus, opposit, sedit, decre, lift 
     Score: martial, opposit, coup, presid, decre, militari, presidenti 
Topic 12 Top Words:
     Highest Prob: refuge, ethnic, tradit, presid, power, peopl, can 
     FREX: king, loan, tradit, role, agricultur, known, citizenship 
     Lift: loan, consensus, king, nonpolit, expatri, monarchi, modern 
     Score: loan, king, ethnic, royal, tradit, dissid, refuge 
Topic 13 Top Words:
     Highest Prob: district, violenc, child, see, death, end, muslim 
     FREX: district, milit, tribal, custodi, bond, injur, villag 
     Lift: milit, cast, tribal, ordin, epz, tribe, brothel 
     Score: milit, ngos, tribal, insurg, traffick, muslim, child 
Topic 14 Top Words:
     Highest Prob: feder, asylum, legisl, immigr, parliament, equal, minor 
     FREX: immigr, asylum, feder, applic, equal, racial, european 
     Lift: kingdom, racist, racism, alien, german, treati, immigr 
     Score: kingdom, parliament, feder, immigr, disabl, asylum, seeker 
Topic 15 Top Words:
     Highest Prob: prosecutor, ethnic, region, presid, media, ministri, parliament 
     FREX: prosecutor, russian, orthodox, registr, regist, soviet, region 
     Lift: russian, russia, orthodox, soviet, jehovah, procur, psychiatr 
     Score: russian, orthodox, soviet, russia, parliament, ethnic, prosecutor 
```

```r
cloud(stm_out, 4) 
```

<img src="https://raw.githubusercontent.com/leondong98/Text-Analysis-Workshop/main/images/4_2.png" width="700"/>
    
```r
cloud(stm_out, 11) 
```

<img src="https://raw.githubusercontent.com/leondong98/Text-Analysis-Workshop/main/images/4_3.png" width="700"/>
    
</details> 
    
4. 访问已估计的 STM 对象中的文档级主题比例（使用 ``stm_out$theta``）。这个矩阵有多少行？有多少列？行和列分别表示什么？
       
<details>
<summary>Reveal Code</summary>
    
```r
dim(stm_out$theta)
```
```
[1] 4067   15   
```
> 这个矩阵有 4067 行, 15 列。行表示文档，列表示主题。矩阵中每个单元格的值表示对应文档 $d$ 被分配给对应主题 $k$ 的比例。

> 例如，我们来看看矩阵的第一行：

```r
stm_out$theta[1,]
```
```
 [1] 0.0039514637 0.0042124561 0.1752190939 0.0002901283 0.0046482334
 [6] 0.6530333191 0.0840681810 0.0003160989 0.0012657616 0.0048301620
[11] 0.0110138327 0.0317336337 0.0016632066 0.0149865858 0.0087678432
```
> 我们可以看到，我们收集的第一份文档主要是关于主题 6 的，因为 65% 的文档分配给了该主题。

    
</details> 
    

5. 选择一个主题，并将其与 ``human_rights`` 数据中的 ``year`` 变量作图。你可以从图中看出什么？

<details>
<summary>Reveal Code</summary>
    
```r
# 将感兴趣的主题分配到数据中
# 我选择了第 4 个主题，你可能选择了其他主题。
human_rights$sexual_violence_topic <- stm_out$theta[,4]

# 绘制主题随年份的变化图
human_rights %>%
  ggplot(aes(x = year, y = sexual_violence_topic)) +
  geom_point(alpha = .2) + 
  theme_bw()
```
<img src="https://raw.githubusercontent.com/leondong98/Text-Analysis-Workshop/main/images/4_4.png" width="700"/>
    
> 随着时间的推移，这一主题在不同国家的报告中变得更加突出。
    
</details> 

## 4.5 有协变量的 STM

1. STM 的一个关键创新在于它允许我们将任意协变量纳入文本模型中，使我们能够评估主题分布如何随着文档元数据而变化。在这个问题中，请重新拟合一个 STM 模型，并在 ``prevalence`` 参数中加入一个协变量。你可以选择任何你认为可能与估计出的主题存在有趣关系的变量。同样的，请记得保存你的模型输出，这样你就不需要多次重新输出估计模型。
    
<details>
<summary>Reveal Code</summary>
    
```r
stm_out_prevalence <- stm(documents = human_rights_dfm,
                          prevalence = ~alliance,
                          K = 15,
                          seed = 12345)
```
```r
save(stm_out_prevalence, file = "stm_out_prevalence.Rdata")
```
                      
</details> 

2. 我们希望能够记录下该模型中估计出的主题，以便后续在绘图函数中使用。请根据每个主题中 “``frex``” 得分最高的词语，创建一个主题标签向量(vector of topic labels)。
    
<details>
<summary>Reveal Code</summary>
    
```r
# 提取每个主题中 frex 得分最高的词构成的矩阵
topic_labels_matrix <- labelTopics(stm_out_prevalence, n = 7)$frex

# 将每个主题的关键词合并成一个标签字符串
topic_labels <- apply(topic_labels_matrix, 1, paste0, collapse = "_")
topic_labels
```
```
 [1] "israel_west_bank_territori_arab_occupi_east"                 
 [2] "code_franc_french_minimum_interior_radio_extrajudici"        
 [3] "war_regim_iraq_southern_revolutionari_insurg_north"          
 [4] "roma_sexual_traffick_societ_corrupt_exploit_victim"          
 [5] "indigen_guerrilla_de_kidnap_paramilitari_congress_prosecutor"
 [6] "guarante_tion_ment_communist_now_growth_current"             
 [7] "provinc_chines_china_provinci_dissid_activist_enterpris"     
 [8] "soldier_rebel_idp_fgm_girl_arm_unlik"                        
 [9] "black_african_south_white_africa_farm_magistr"               
[10] "islam_sharia_non-muslim_king_muslim_bahai_christian"         
[11] "opposit_decre_coup_martial_ralli_ban_newspap"                
[12] "king_loan_role_tradit_agricultur_known_citizenship"          
[13] "district_milit_tribal_bond_custodi_injur_villag"             
[14] "immigr_asylum_feder_applic_equal_racial_european"            
[15] "prosecutor_russian_orthodox_registr_regist_soviet_region"  
```
      
> 请注意，这里的主题与我们在不使用协变量的 STM 中所提取的主题略有不同。这是因为我们在此处估计的是一个略有不同的模型，导致对词的分布也有所不同。这是主题模型的一个核心弱点：**模型结果在一定程度上对模型设定敏感**，包括主题数量、初始化方式、协变量的引入等因素都可能影响最终的主题结构。

</details> 

3. 使用 ``estimateEffect()`` 函数估计数据集中一个协变量在主题使用方面的差异。该函数需要三个主要参数：

| 参数      | 描述                                                                                     |
|-------------|----------------------------------------------------------------------------------------------|
| `formula`   | 回归所用的公式。格式应为 `c(1,2,3) ~ covariate_name`，左侧的数字表示你希望估计效应的主题编号。 |
| `stmobj`    | `stm()` 函数生成的模型输出。                                                                |
| `metadata`  | 一个包含协变量的数据框（`data.frame`）。你可以使用 `docvars(my_dfm)` 来提取你用于建模的 `dfm` 中的协变量。 |
    
<details>
<summary>Reveal Code</summary>
    
```r
# 估计与美国结盟对所有主题的影响
prevalence_effects <- estimateEffect(
  formula = c(1:15) ~ alliance,         # 对第 1 到第 15 个主题建模
  stmobj = stm_out_prevalence,          # 使用带协变量的 STM 模型
  metadata = docvars(human_rights_dfm)  # 提供文档元数据（用于读取协变量）
)
```

</details>

4. 使用 ``summary()`` 函数提取估计的回归系数。对于哪些主题，你发现与所选协变量存在显著关系的证据？

<details>
<summary>Reveal Code</summary>
    
```r
summary(prevalence_effects)
```
    
```
Call:
estimateEffect(formula = c(1:15) ~ alliance, stmobj = stm_out_prevalence, 
    metadata = docvars(human_rights_dfm))


Topic 1:

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.018014   0.001535  11.739  < 2e-16 ***
alliance    -0.010863   0.002554  -4.253 2.16e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Topic 2:

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.088464   0.003031  29.182   <2e-16 ***
alliance    -0.011958   0.005530  -2.162   0.0307 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Topic 3:

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.062277   0.002563  24.303  < 2e-16 ***
alliance    -0.029942   0.004457  -6.719 2.09e-11 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Topic 4:

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 0.113109   0.004461  25.356  < 2e-16 ***
alliance    0.034314   0.007992   4.293  1.8e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Topic 5:

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 0.012421   0.002691   4.616 4.03e-06 ***
alliance    0.185554   0.005944  31.218  < 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Topic 6:

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 0.081515   0.003665  22.243  < 2e-16 ***
alliance    0.044115   0.006689   6.596 4.78e-11 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Topic 7:

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.041081   0.002387  17.210   <2e-16 ***
alliance    -0.008466   0.003995  -2.119   0.0341 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Topic 8:

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.078359   0.003186   24.59   <2e-16 ***
alliance    -0.059236   0.005231  -11.32   <2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Topic 9:

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.045399   0.002326  19.516  < 2e-16 ***
alliance    -0.023675   0.003738  -6.334 2.65e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Topic 10:

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.076367   0.003208   23.80   <2e-16 ***
alliance    -0.056660   0.005144  -11.01   <2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Topic 11:

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.077145   0.002698  28.595   <2e-16 ***
alliance    -0.007542   0.004602  -1.639    0.101    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Topic 12:

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.103965   0.002956   35.17   <2e-16 ***
alliance    -0.073486   0.004845  -15.17   <2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Topic 13:

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.049324   0.002583  19.096  < 2e-16 ***
alliance    -0.016406   0.004569  -3.591 0.000334 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Topic 14:

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 0.071055   0.003512   20.23   <2e-16 ***
alliance    0.077002   0.006412   12.01   <2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Topic 15:

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.081439   0.003383  24.070  < 2e-16 ***
alliance    -0.042845   0.006304  -6.796 1.23e-11 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```

> 大部分都是！

</details>
    

4. 使用 ``plot.estimateEffect()`` 函数绘制你刚才估计出的一些更有趣的差异。该函数可以接受多个不同的参数。你可以参阅该函数的帮助文件（``?plot.estimateEffect``）

<details>
<summary>Reveal Code</summary>
    
```r
plot.estimateEffect(prevalence_effects,
     topics = 4,
     covariate = "alliance",
     method = "pointestimate",
     main = topic_labels[4])
```

<img src="https://raw.githubusercontent.com/leondong98/Text-Analysis-Workshop/main/images/4_5.png" width="700"/>
    
```r
plot.estimateEffect(prevalence_effects,
     topics = 14,
     covariate = "alliance",
     method = "pointestimate",
     main = topic_labels[14])
```

<img src="https://raw.githubusercontent.com/leondong98/Text-Analysis-Workshop/main/images/4_6.png" width="700"/>

</details>

